<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fetch CSV File</title>
    <!-- https://medium.com/@ryan_forrester_/read-csv-files-in-javascript-how-to-guide-8d0ac6df082a -->

    <!-- CSV 파일 로드 라이브러리 : https://www.papaparse.com/ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>

</head>
<body>
    <pre id="output"></pre>

    <script>
        async function fetchCSV(url) {
            try {
                const response = await fetch(url);
                const data = await response.text();

                // document.getElementById('output').innerText = data;

                // CSV -> JSON
                // https://www.papaparse.com/
                // https://www.papaparse.com/docs#csv-to-json

                let json = Papa.parse(data.trim(),{header : true}); // 공백 제거 + header 삽입
                // console.log("json :", json);

                let products = json.data;
                
                console.log("상품 정보", products); // 상품 정보
                console.log("상품 수 :", products.length); // 상품 수

                // for ... of : 전체 상품들 출력
                for (let product of products) {
                    // console.log("product :", product);
                    // 포맷터(형식자) 출력 %s (string) : 문자열
                    // 상품 아이디, 상품명, 상품 이미지, 브랜드명, 단가, 신상품 여부, 추천수, 리뷰수
                    console.log("상품 이미지: %s", product["상품 아이디"]+"_LM1.jpg");
                    console.log("상품명 : %s", product["상품명"]);
                    console.log("상품 브랜드 : %s", product["브랜드명"]);
                    console.log("상품 가격 : %s", product["단가"]);
                    console.log("신상품 여부 : %s", 
                                (product["신상품 여부"] == 'O' ? "신상품" : "기존상품"));
                    console.log("추천 점수 : %d", product["추천수"]);
                    console.log("----------------------------");

                } // for



            } catch (error) {
                console.error('Error fetching CSV:', error);
            }
        }

        // fetchCSV('https://example.com/data.csv');
        fetchCSV('../csv/상품정보-추가상품.csv');
    </script>
</body>
</html>